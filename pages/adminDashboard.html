<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard | AI Fitness</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Share+Tech+Mono&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    /* ══════════════════════════════════════════════
       VARIABLES
    ══════════════════════════════════════════════ */
    :root {
      --cyan:      #00f5c8;
      --cyan-dim:  rgba(0,245,200,0.1);
      --cyan-glow: rgba(0,245,200,0.35);
      --red:       #ff2d2d;
      --red-dim:   rgba(255,45,45,0.1);
      --orange:    #ff6b2b;
      --amber:     #ffb347;
      --dark:      #050810;
      --surface:   #0b1018;
      --surface-2: #111822;
      --surface-3: #161f2c;
      --border:    rgba(255,255,255,0.06);
      --border-c:  rgba(0,245,200,0.18);
      --border-r:  rgba(255,45,45,0.2);
      --text:      #ddeeff;
      --muted:     rgba(221,238,255,0.42);
      --nav-h:     68px;
    }

    /* ══════════════════════════════════════════════
       RESET
    ══════════════════════════════════════════════ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--dark);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ── Background layers ── */
    body::before {
      content: '';
      position: fixed; inset: 0;
      background:
        radial-gradient(ellipse 65% 55% at 5%   5%,  rgba(0,245,200,0.06) 0%, transparent 55%),
        radial-gradient(ellipse 50% 55% at 95% 95%, rgba(255,45,45,0.05)  0%, transparent 50%),
        radial-gradient(ellipse 40% 45% at 50% 50%, rgba(0,50,200,0.03)   0%, transparent 60%);
      pointer-events: none; z-index: 0;
    }

    body::after {
      content: '';
      position: fixed; inset: 0;
      background-image: radial-gradient(circle, rgba(0,245,200,0.05) 1px, transparent 1px);
      background-size: 30px 30px;
      pointer-events: none; z-index: 0;
    }

    /* ══════════════════════════════════════════════
       HEADER
    ══════════════════════════════════════════════ */
    .header {
      position: sticky; top: 0; z-index: 200;
      height: var(--nav-h);
      display: flex; align-items: center;
      justify-content: space-between;
      padding: 0 clamp(16px, 4vw, 48px);
      background: rgba(5,8,16,0.88);
      backdrop-filter: blur(20px) saturate(160%);
      -webkit-backdrop-filter: blur(20px) saturate(160%);
      border-bottom: 1px solid var(--border);
      animation: hdr-in 0.6s ease both;
    }

    @keyframes hdr-in {
      from { opacity:0; transform:translateY(-100%); }
      to   { opacity:1; transform:translateY(0); }
    }

    header::before,
    .header::before {
      content: '';
      position: absolute; top:0; left:0; right:0; height:1px;
      background: linear-gradient(90deg, transparent, var(--cyan) 35%, var(--red) 75%, transparent);
    }

    .header-left { display: flex; align-items: center; gap: 14px; }

    .header-logo {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(22px,3vw,30px);
      letter-spacing: 5px;
      background: linear-gradient(135deg, var(--cyan) 0%, #fff 55%, var(--red) 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 0 10px rgba(0,245,200,0.35));
    }

    .admin-badge {
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; letter-spacing: 2px; text-transform: uppercase;
      color: var(--red);
      background: var(--red-dim);
      border: 1px solid var(--border-r);
      padding: 3px 9px; border-radius: 4px;
    }

    .status-indicator {
      display: flex; align-items: center; gap: 7px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; letter-spacing: 1.5px;
      color: var(--muted);
    }

    .status-indicator::before {
      content: '';
      width: 7px; height: 7px;
      background: var(--cyan); border-radius: 50%;
      box-shadow: 0 0 8px var(--cyan);
      animation: blink 2s ease-in-out infinite;
    }

    @keyframes blink { 0%,100%{opacity:1;} 50%{opacity:0.25;} }

    .logout-btn {
      font-family: 'DM Sans', sans-serif;
      font-size: 12px; font-weight: 600;
      letter-spacing: 1.5px; text-transform: uppercase;
      height: 36px; padding: 0 18px;
      background: transparent;
      color: var(--red);
      border: 1px solid rgba(255,45,45,0.35);
      border-radius: 6px; cursor: pointer;
      position: relative; overflow: hidden;
      transition: all 0.22s ease;
    }

    .logout-btn::before {
      content: '';
      position: absolute; inset: 0;
      background: var(--red-dim);
      transform: scaleX(0); transform-origin: left;
      transition: transform 0.25s ease;
    }

    .logout-btn:hover { border-color:var(--red); color:#fff; box-shadow:0 0 14px rgba(255,45,45,0.3); }
    .logout-btn:hover::before { transform: scaleX(1); }

    /* ══════════════════════════════════════════════
       MAIN CONTAINER
    ══════════════════════════════════════════════ */
    .container {
      position: relative; z-index: 1;
      padding: clamp(20px,4vw,44px) clamp(16px,4vw,48px);
      max-width: 1500px; margin: 0 auto;
    }

    /* ── Page title ── */
    .page-title {
      margin-bottom: 36px;
      animation: fade-up 0.5s 0.2s ease both;
    }

    @keyframes fade-up {
      from { opacity:0; transform:translateY(14px); }
      to   { opacity:1; transform:translateY(0); }
    }

    .page-title h1 {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(32px,5vw,56px);
      letter-spacing: 4px; line-height: 1;
      background: linear-gradient(120deg, #fff 0%, var(--cyan) 40%, var(--orange) 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 0 20px rgba(0,245,200,0.18));
    }

    .page-title p {
      font-family: 'Share Tech Mono', monospace;
      font-size: 11px; letter-spacing: 3px;
      color: var(--muted); text-transform: uppercase;
      margin-top: 4px;
    }

    /* ── Section heading ── */
    .section-head {
      display: flex; align-items: center; gap: 14px;
      margin-bottom: 18px;
    }

    .section-head h2 {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(18px,2.5vw,22px);
      letter-spacing: 3px; color: var(--text);
    }

    .section-head::after {
      content: ''; flex: 1; height: 1px;
      background: linear-gradient(90deg, var(--border-c), transparent);
    }

    /* ══════════════════════════════════════════════
       STATS GRID
    ══════════════════════════════════════════════ */
    .stats {
      display: grid;
      grid-template-columns: repeat(4,1fr);
      gap: 16px;
      margin-bottom: 40px;
      animation: fade-up 0.5s 0.28s ease both;
    }

    @media (max-width: 900px) { .stats { grid-template-columns: repeat(2,1fr); } }
    @media (max-width: 480px) { .stats { grid-template-columns: 1fr; } }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 22px 20px 18px;
      position: relative; overflow: hidden;
      transition: transform 0.25s cubic-bezier(.34,1.56,.64,1), border-color 0.25s ease, box-shadow 0.25s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      border-color: var(--border-c);
      box-shadow: 0 12px 36px rgba(0,245,200,0.1);
    }

    /* Card top accent */
    .card::before {
      content: '';
      position: absolute; top:0; left:0; right:0; height:2px;
    }

    .card:nth-child(1)::before { background: linear-gradient(90deg, var(--cyan), transparent); }
    .card:nth-child(2)::before { background: linear-gradient(90deg, var(--amber), transparent); }
    .card:nth-child(3)::before { background: linear-gradient(90deg, var(--red), transparent); }
    .card:nth-child(4)::before { background: linear-gradient(90deg, #7c6aff, transparent); }

    /* Ring chart inside card */
    .card-inner {
      display: flex; align-items: center; gap: 18px;
    }

    .ring-wrap {
      position: relative; flex-shrink: 0;
      width: 68px; height: 68px;
    }

    .ring-wrap svg {
      width: 68px; height: 68px;
      transform: rotate(-90deg);
    }

    .ring-track {
      fill: none; stroke: var(--surface-2); stroke-width: 6;
    }

    .ring-fill {
      fill: none; stroke-width: 6;
      stroke-linecap: round;
      stroke-dasharray: 176;
      stroke-dashoffset: 176;
      transition: stroke-dashoffset 1.4s cubic-bezier(.4,0,.2,1);
    }

    .ring-fill.cyan   { stroke: var(--cyan);   filter: drop-shadow(0 0 5px var(--cyan)); }
    .ring-fill.amber  { stroke: var(--amber);  filter: drop-shadow(0 0 5px var(--amber)); }
    .ring-fill.red    { stroke: var(--red);    filter: drop-shadow(0 0 5px var(--red)); }
    .ring-fill.purple { stroke: #7c6aff;       filter: drop-shadow(0 0 5px #7c6aff); }

    .ring-label {
      position: absolute; top:50%; left:50%;
      transform: translate(-50%,-50%);
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; color: var(--muted);
      letter-spacing: 0.5px;
    }

    .card-text h3 {
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; letter-spacing: 2px;
      text-transform: uppercase; color: var(--muted);
      margin-bottom: 6px;
    }

    .card-text p {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 40px; letter-spacing: 2px;
      line-height: 1; color: var(--text);
    }

    .card:nth-child(1) .card-text p { color: var(--cyan);   text-shadow: 0 0 20px rgba(0,245,200,0.4); }
    .card:nth-child(2) .card-text p { color: var(--amber);  text-shadow: 0 0 20px rgba(255,179,71,0.4); }
    .card:nth-child(3) .card-text p { color: var(--red);    text-shadow: 0 0 20px rgba(255,45,45,0.4); }
    .card:nth-child(4) .card-text p { color: #7c6aff;       text-shadow: 0 0 20px rgba(124,106,255,0.4); }

    .card-delta {
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; color: var(--muted);
      margin-top: 3px; letter-spacing: 1px;
    }

    /* ══════════════════════════════════════════════
       CHART ROW
    ══════════════════════════════════════════════ */
    .charts-row {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 16px;
      margin-bottom: 40px;
      animation: fade-up 0.5s 0.36s ease both;
    }

    @media (max-width: 860px) {
      .charts-row { grid-template-columns: 1fr; }
    }

    .chart-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 24px;
      position: relative; overflow: hidden;
    }

    .chart-card::before {
      content: '';
      position: absolute; top:0; left:0; right:0; height:1px;
      background: linear-gradient(90deg, var(--cyan), transparent 60%);
    }

    /* Bar chart */
    .bar-chart {
      display: flex;
      align-items: flex-end;
      gap: clamp(6px, 1.5vw, 12px);
      height: 140px;
      padding-top: 12px;
    }

    .bar-col {
      flex: 1;
      display: flex; flex-direction: column;
      align-items: center; gap: 6px;
    }

    .bar-val {
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; color: var(--muted);
    }

    .bar-body {
      width: 100%;
      border-radius: 4px 4px 0 0;
      min-height: 4px;
      transform-origin: bottom;
      animation: bar-grow 1s cubic-bezier(.4,0,.2,1) both;
    }

    @keyframes bar-grow {
      from { transform: scaleY(0); opacity:0; }
      to   { transform: scaleY(1); opacity:1; }
    }

    .bar-col:nth-child(1) .bar-body { background: linear-gradient(to top, var(--cyan), rgba(0,245,200,0.4)); animation-delay:0.4s; }
    .bar-col:nth-child(2) .bar-body { background: linear-gradient(to top, var(--amber),rgba(255,179,71,0.4)); animation-delay:0.5s; }
    .bar-col:nth-child(3) .bar-body { background: linear-gradient(to top, var(--red),rgba(255,45,45,0.4)); animation-delay:0.6s; }
    .bar-col:nth-child(4) .bar-body { background: linear-gradient(to top, #7c6aff,rgba(124,106,255,0.4)); animation-delay:0.7s; }

    .bar-label {
      font-family: 'Share Tech Mono', monospace;
      font-size: 9px; letter-spacing: 1px;
      color: var(--muted); text-transform: uppercase;
      text-align: center;
    }

    /* Donut chart */
    .donut-wrap {
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      gap: 20px;
      height: 100%;
    }

    .donut-wrap svg {
      width: 130px; height: 130px;
      transform: rotate(-90deg);
      overflow: visible;
    }

    .donut-seg {
      fill: none;
      stroke-width: 18;
      stroke-linecap: round;
      stroke-dasharray: 314;
      stroke-dashoffset: 314;
      transition: stroke-dashoffset 1.2s cubic-bezier(.4,0,.2,1);
    }

    .donut-legend {
      display: flex; flex-direction: column; gap: 8px;
      width: 100%;
    }

    .legend-row {
      display: flex; align-items: center; gap: 10px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 11px; color: var(--muted);
    }

    .legend-dot {
      width: 8px; height: 8px;
      border-radius: 50%; flex-shrink:0;
    }

    .legend-pct {
      margin-left: auto;
      font-size: 12px; font-weight: 600;
    }

    /* ══════════════════════════════════════════════
       USER TABLE
    ══════════════════════════════════════════════ */
    .table-section {
      animation: fade-up 0.5s 0.44s ease both;
    }

    .table-container {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
    }

    /* Search / filter bar */
    .table-toolbar {
      display: flex; align-items: center; gap: 12px;
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
      flex-wrap: wrap;
    }

    .search-wrap {
      position: relative; flex: 1; min-width: 180px;
    }

    .search-icon {
      position: absolute; left:12px; top:50%;
      transform: translateY(-50%);
      font-size: 13px; color: var(--muted);
      pointer-events: none;
    }

    .search-input {
      width: 100%; height: 36px;
      padding: 0 12px 0 34px;
      background: var(--surface-2);
      border: 1px solid var(--border);
      border-radius: 7px;
      color: var(--text);
      font-family: 'Share Tech Mono', monospace;
      font-size: 12px; letter-spacing: 1px;
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .search-input::placeholder { color: rgba(221,238,255,0.2); }
    .search-input:focus {
      border-color: var(--border-c);
      box-shadow: 0 0 0 2px rgba(0,245,200,0.08);
    }

    .user-count-pill {
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; letter-spacing: 2px;
      color: var(--cyan);
      background: var(--cyan-dim);
      border: 1px solid var(--border-c);
      padding: 4px 10px; border-radius: 4px;
      white-space: nowrap;
    }

    /* Table */
    .table-scroll { overflow-x: auto; }

    table {
      width: 100%; border-collapse: collapse;
      min-width: 960px;
    }

    thead tr {
      background: var(--surface-2);
      border-bottom: 1px solid var(--border);
    }

    th {
      padding: 13px 14px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; letter-spacing: 2px;
      text-transform: uppercase; color: var(--muted);
      text-align: left; white-space: nowrap;
    }

    th:first-child { border-left: 2px solid var(--cyan); padding-left: 16px; }

    tbody tr {
      border-bottom: 1px solid var(--border);
      transition: background 0.2s;
    }

    tbody tr:hover { background: rgba(0,245,200,0.025); }
    tbody tr:last-child { border-bottom: none; }

    td {
      padding: 13px 14px;
      font-size: 13px; color: var(--text);
      text-align: left; white-space: nowrap;
    }

    td:first-child { padding-left: 16px; }

    /* Avatar cell */
    .user-cell {
      display: flex; align-items: center; gap: 10px;
    }

    .user-avatar {
      width: 32px; height: 32px; border-radius: 50%;
      background: linear-gradient(135deg, var(--surface-3), var(--surface-2));
      border: 1px solid var(--border);
      display: flex; align-items: center; justify-content: center;
      font-family: 'Bebas Neue', sans-serif;
      font-size: 14px; color: var(--cyan); flex-shrink: 0;
    }

    /* Role badges */
    .role-admin {
      display: inline-flex; align-items: center; gap: 5px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--red);
      background: var(--red-dim);
      border: 1px solid var(--border-r);
      padding: 3px 8px; border-radius: 4px;
      font-weight: normal;
    }

    .role-user {
      display: inline-flex; align-items: center; gap: 5px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--cyan);
      background: var(--cyan-dim);
      border: 1px solid var(--border-c);
      padding: 3px 8px; border-radius: 4px;
      font-weight: normal;
    }

    .role-dot {
      width: 5px; height: 5px; border-radius: 50();
      flex-shrink: 0;
    }

    .role-admin .role-dot { background: var(--red); box-shadow: 0 0 5px var(--red); border-radius:50%; }
    .role-user  .role-dot { background: var(--cyan); box-shadow: 0 0 5px var(--cyan); border-radius:50%; }

    /* Delete button */
    .delete-btn {
      font-family: 'Share Tech Mono', monospace;
      font-size: 10px; letter-spacing: 1.5px;
      text-transform: uppercase;
      height: 30px; padding: 0 12px;
      background: transparent;
      color: var(--red);
      border: 1px solid rgba(255,45,45,0.3);
      border-radius: 5px; cursor: pointer;
      position: relative; overflow: hidden;
      transition: all 0.2s ease;
    }

    .delete-btn::before {
      content: '';
      position: absolute; inset:0;
      background: var(--red-dim);
      transform: scaleX(0); transform-origin: left;
      transition: transform 0.22s ease;
    }

    .delete-btn:hover {
      border-color: var(--red); color: #fff;
      box-shadow: 0 0 12px rgba(255,45,45,0.25);
      transform: scale(1.05);
    }

    .delete-btn:hover::before { transform: scaleX(1); }

    /* Empty state */
    .empty-row td {
      text-align: center;
      padding: 48px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 12px; letter-spacing: 2px;
      color: var(--muted); text-transform: uppercase;
    }

    /* ══════════════════════════════════════════════
       SCROLLBAR
    ══════════════════════════════════════════════ */
    ::-webkit-scrollbar { width: 5px; height: 5px; }
    ::-webkit-scrollbar-track { background: var(--dark); }
    ::-webkit-scrollbar-thumb { background: rgba(0,245,200,0.18); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(0,245,200,0.36); }

    /* ══════════════════════════════════════════════
       RESPONSIVE
    ══════════════════════════════════════════════ */
    @media (max-width: 768px) {
      .page-title h1 { font-size: clamp(26px,7vw,40px); }
    }
  </style>
</head>

<body>

  <!-- ══════════ HEADER ══════════════════════════════════ -->
  <div class="header">
    <div class="header-left">
      <div class="header-logo">Fit Club</div>
      <span class="admin-badge">Admin</span>
      <span class="status-indicator">Control Center</span>
    </div>
    <button class="logout-btn" onclick="logout()">⬡ Logout</button>
  </div>

  <div class="container">

    <!-- Page title -->
    <div class="page-title">
      <h1>Admin Dashboard</h1>
      <p>// AI Fitness — User Management &amp; Analytics</p>
    </div>

    <!-- ══════════ STAT CARDS ═══════════════════════════ -->
    <div class="section-head"><h2>Overview</h2></div>
    <div class="stats">

      <div class="card">
        <div class="card-inner">
          <div class="ring-wrap">
            <svg viewBox="0 0 68 68">
              <circle class="ring-track" cx="34" cy="34" r="28"/>
              <circle class="ring-fill cyan" cx="34" cy="34" r="28" id="ring0"/>
            </svg>
            <div class="ring-label" id="ring0lbl">—</div>
          </div>
          <div class="card-text">
            <h3>Total Users</h3>
            <p id="totalUsers">0</p>
            <div class="card-delta">All registered</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-inner">
          <div class="ring-wrap">
            <svg viewBox="0 0 68 68">
              <circle class="ring-track" cx="34" cy="34" r="28"/>
              <circle class="ring-fill amber" cx="34" cy="34" r="28" id="ring1"/>
            </svg>
            <div class="ring-label" id="ring1lbl">—</div>
          </div>
          <div class="card-text">
            <h3>Active Users</h3>
            <p id="activeUsers">0</p>
            <div class="card-delta">Regular members</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-inner">
          <div class="ring-wrap">
            <svg viewBox="0 0 68 68">
              <circle class="ring-track" cx="34" cy="34" r="28"/>
              <circle class="ring-fill red" cx="34" cy="34" r="28" id="ring2"/>
            </svg>
            <div class="ring-label" id="ring2lbl">—</div>
          </div>
          <div class="card-text">
            <h3>Admins</h3>
            <p id="adminCount">0</p>
            <div class="card-delta">Privileged access</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-inner">
          <div class="ring-wrap">
            <svg viewBox="0 0 68 68">
              <circle class="ring-track" cx="34" cy="34" r="28"/>
              <circle class="ring-fill purple" cx="34" cy="34" r="28" id="ring3"/>
            </svg>
            <div class="ring-label" id="ring3lbl">—</div>
          </div>
          <div class="card-text">
            <h3>Normal Users</h3>
            <p id="userCount">0</p>
            <div class="card-delta">Standard members</div>
          </div>
        </div>
      </div>

    </div>

    <!-- ══════════ CHARTS ════════════════════════════════ -->
    <div class="section-head"><h2>Analytics</h2></div>
    <div class="charts-row">

      <!-- Bar chart -->
      <div class="chart-card">
        <div class="section-head" style="margin-bottom:12px;">
          <h2 style="font-size:15px; letter-spacing:2px;">User Distribution</h2>
        </div>
        <div class="bar-chart" id="barChart">
          <div class="bar-col">
            <div class="bar-val" id="bv0">0</div>
            <div class="bar-body" id="bb0" style="height:4px;"></div>
            <div class="bar-label">Total</div>
          </div>
          <div class="bar-col">
            <div class="bar-val" id="bv1">0</div>
            <div class="bar-body" id="bb1" style="height:4px;"></div>
            <div class="bar-label">Active</div>
          </div>
          <div class="bar-col">
            <div class="bar-val" id="bv2">0</div>
            <div class="bar-body" id="bb2" style="height:4px;"></div>
            <div class="bar-label">Admins</div>
          </div>
          <div class="bar-col">
            <div class="bar-val" id="bv3">0</div>
            <div class="bar-body" id="bb3" style="height:4px;"></div>
            <div class="bar-label">Normal</div>
          </div>
        </div>
      </div>

      <!-- Donut chart -->
      <div class="chart-card">
        <div class="section-head" style="margin-bottom:12px;">
          <h2 style="font-size:15px; letter-spacing:2px;">Role Split</h2>
        </div>
        <div class="donut-wrap">
          <svg viewBox="0 0 100 100" id="donutSvg">
            <circle cx="50" cy="50" r="50" fill="none" stroke="var(--surface-2)" stroke-width="18"/>
            <circle class="donut-seg" cx="50" cy="50" r="50" id="donut0"
              stroke="var(--cyan)"   style="filter:drop-shadow(0 0 5px var(--cyan))"/>
            <circle class="donut-seg" cx="50" cy="50" r="50" id="donut1"
              stroke="var(--red)"    style="filter:drop-shadow(0 0 5px var(--red))"/>
          </svg>
          <div class="donut-legend">
            <div class="legend-row">
              <span class="legend-dot" style="background:var(--cyan);box-shadow:0 0 6px var(--cyan);border-radius:50%;"></span>
              <span>Regular Users</span>
              <span class="legend-pct" id="pctUser" style="color:var(--cyan)">0%</span>
            </div>
            <div class="legend-row">
              <span class="legend-dot" style="background:var(--red);box-shadow:0 0 6px var(--red);border-radius:50%;"></span>
              <span>Admins</span>
              <span class="legend-pct" id="pctAdmin" style="color:var(--red)">0%</span>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- ══════════ TABLE ═════════════════════════════════ -->
    <div class="table-section">
      <div class="section-head"><h2>User Management</h2></div>
      <div class="table-container">
        <div class="table-toolbar">
          <div class="search-wrap">
            <span class="search-icon">⌕</span>
            <input class="search-input" id="searchInput" placeholder="Search users..." oninput="filterTable()">
          </div>
          <span class="user-count-pill" id="tableCount">0 Users</span>
        </div>
        <div class="table-scroll">
          <table>
            <thead>
              <tr>
                <th>User</th>
                <th>Username</th>
                <th>Email</th>
                <th>Age</th>
                <th>Gender</th>
                <th>Height</th>
                <th>Weight</th>
                <th>Goal</th>
                <th>Experience</th>
                <th>Role</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="userTable"></tbody>
          </table>
        </div>
      </div>
    </div>

  </div><!-- /container -->

  <!-- ══════════ ORIGINAL JS (zero changes to logic) ═══ -->
  <script>
    const token = localStorage.getItem("token");
    const role  = localStorage.getItem("role");

    if (!token || role !== "admin") {
      alert("Admin access only!");
      window.location.href = "login.html";
    }

    async function fetchUsers() {
      try {
        const res = await fetch("http://localhost:5000/api/admin/users", {
          headers: { Authorization: "Bearer " + token },
        });

        if (!res.ok) throw new Error("Unauthorized");

        const users = await res.json();
        const table = document.getElementById("userTable");
        table.innerHTML = "";

        let adminCount  = 0;
        let userCount   = 0;
        let activeUsers = 0;

        users.forEach((user) => {
          if (user.role === "admin") adminCount++;
          if (user.role === "user") {
            userCount++;
            activeUsers++;
          }

          /* ── avatar initials ── */
          const initials = (user.fullName || user.username || "?")
            .split(" ").map(w => w[0]).join("").slice(0,2).toUpperCase();

          table.innerHTML += `
            <tr>
              <td>
                <div class="user-cell">
                  <div class="user-avatar">${initials}</div>
                  ${user.fullName || "-"}
                </div>
              </td>
              <td>${user.username || "-"}</td>
              <td>${user.email    || "-"}</td>
              <td>${user.age      || "-"}</td>
              <td>${user.gender   || "-"}</td>
              <td>${user.height   || "-"}</td>
              <td>${user.weight   || "-"}</td>
              <td>${user.goal     || "-"}</td>
              <td>${user.experience || "-"}</td>
              <td>
                <span class="${user.role === "admin" ? "role-admin" : "role-user"}">
                  <span class="role-dot"></span>${user.role}
                </span>
              </td>
              <td>
                <button class="delete-btn" onclick="deleteUser('${user._id}')">
                  ✕ Delete
                </button>
              </td>
            </tr>`;
        });

        if (users.length === 0) {
          table.innerHTML = `<tr class="empty-row"><td colspan="11">// No users found in database</td></tr>`;
        }

        const total = users.length;
        document.getElementById("totalUsers").innerText  = total;
        document.getElementById("adminCount").innerText  = adminCount;
        document.getElementById("userCount").innerText   = userCount;
        document.getElementById("activeUsers").innerText = activeUsers;
        document.getElementById("tableCount").innerText  = total + " Users";

        /* ── animate ring charts ── */
        const circumference = 2 * Math.PI * 28; // ≈ 175.9
        const maxVal = total || 1;
        const vals = [total, activeUsers, adminCount, userCount];
        vals.forEach((v, i) => {
          const pct    = v / maxVal;
          const offset = circumference * (1 - pct);
          const el     = document.getElementById("ring" + i);
          const lbl    = document.getElementById("ring" + i + "lbl");
          if (el) { setTimeout(() => { el.style.strokeDashoffset = offset; }, 300); }
          if (lbl) lbl.textContent = Math.round(pct * 100) + "%";
        });

        /* ── animate bar chart ── */
        const maxBar = Math.max(total, 1);
        const barVals = [total, activeUsers, adminCount, userCount];
        barVals.forEach((v, i) => {
          const h = Math.max(4, Math.round((v / maxBar) * 120));
          document.getElementById("bb" + i).style.height = h + "px";
          document.getElementById("bv" + i).textContent  = v;
        });

        /* ── animate donut ── */
        const circ2 = 2 * Math.PI * 50; // 314.16
        const userPct  = total ? userCount  / total : 0;
        const adminPct = total ? adminCount / total : 0;

        const d0 = document.getElementById("donut0");
        const d1 = document.getElementById("donut1");

        const userDash  = circ2 * userPct;
        const adminDash = circ2 * adminPct;

        setTimeout(() => {
          d0.style.strokeDasharray  = userDash  + " " + circ2;
          d0.style.strokeDashoffset = 0;
          d1.style.strokeDasharray  = adminDash + " " + circ2;
          d1.style.strokeDashoffset = -(userDash);
        }, 400);

        document.getElementById("pctUser").textContent  = Math.round(userPct  * 100) + "%";
        document.getElementById("pctAdmin").textContent = Math.round(adminPct * 100) + "%";

      } catch (err) {
        alert("Unauthorized Access");
        window.location.href = "login.html";
      }
    }

    async function deleteUser(id) {
      if (!confirm("Delete this user?")) return;
      await fetch(`http://localhost:5000/api/admin/user/${id}`, {
        method: "DELETE",
        headers: { Authorization: "Bearer " + token },
      });
      fetchUsers();
    }

    function logout() {
      localStorage.removeItem("token");
      localStorage.removeItem("role");
      window.location.href = "/index.html";
    }

    /* ── Client-side search ── */
    function filterTable() {
      const q = document.getElementById("searchInput").value.toLowerCase();
      const rows = document.querySelectorAll("#userTable tr:not(.empty-row)");
      let visible = 0;
      rows.forEach(r => {
        const match = r.textContent.toLowerCase().includes(q);
        r.style.display = match ? "" : "none";
        if (match) visible++;
      });
      document.getElementById("tableCount").textContent = visible + " Users";
    }

    fetchUsers();
  </script>

</body>
</html>